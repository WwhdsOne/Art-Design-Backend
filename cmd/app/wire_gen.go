// Code generated by Wire. DO NOT EDIT.

//go:generate go run -mod=mod github.com/google/wire/cmd/wire
//go:build !wireinject
// +build !wireinject

package main

import (
	"Art-Design-Backend/config"
	"Art-Design-Backend/internal/bootstrap"
	"Art-Design-Backend/internal/controller"
	"Art-Design-Backend/internal/repository"
	"Art-Design-Backend/internal/repository/cache"
	"Art-Design-Backend/internal/repository/db"
	"Art-Design-Backend/internal/service"
)

// Injectors from wire.go:

// 构造函数是因为初始化时有其他操作
// wire.Struct则只需要构造一个结构体
func wireApp() *bootstrap.HTTPServer {
	configConfig := config.LoadConfig()
	redisWrapper := bootstrap.InitRedis(configConfig)
	jwt := bootstrap.InitJWT(configConfig)
	logger := bootstrap.InitLogger(configConfig)
	gormDB := bootstrap.InitGorm(configConfig, logger)
	operationLogDB := db.NewOperationLogDB(gormDB)
	middlewares := bootstrap.InitMiddleware(configConfig, redisWrapper, jwt, operationLogDB)
	middleware := config.ProviderMiddlewareConfig()
	engine := bootstrap.InitGin(middlewares, logger, middleware)
	userDB := db.NewUserDB(gormDB)
	userCache := cache.NewUserCache(redisWrapper)
	roleCache := cache.NewRoleCache(redisWrapper)
	userRepo := &repository.UserRepo{
		UserDB:    userDB,
		UserCache: userCache,
		RoleCache: roleCache,
	}
	authCache := cache.NewAuthCache(redisWrapper)
	authRepo := &repository.AuthRepo{
		AuthCache: authCache,
	}
	roleDB := db.NewRoleDB(gormDB)
	roleMenusDB := db.NewRoleMenusDB(gormDB)
	userRolesDB := db.NewUserRolesDB(gormDB)
	roleRepo := &repository.RoleRepo{
		RoleDB:      roleDB,
		RoleMenusDB: roleMenusDB,
		RoleCache:   roleCache,
		UserCache:   userCache,
		UserRolesDB: userRolesDB,
	}
	gormTransactionManager := db.NewGormTransactionManager(gormDB)
	defaultUserConfig := config.ProvideDefaultUserConfig()
	authService := &service.AuthService{
		UserRepo:          userRepo,
		AuthRepo:          authRepo,
		RoleRepo:          roleRepo,
		GormTX:            gormTransactionManager,
		Jwt:               jwt,
		DefaultUserConfig: defaultUserConfig,
	}
	authController := controller.NewAuthController(engine, middlewares, authService)
	ossClient := bootstrap.InitOSSClient(configConfig)
	userService := &service.UserService{
		RoleRepo:          roleRepo,
		UserRepo:          userRepo,
		AuthRepo:          authRepo,
		GormTX:            gormTransactionManager,
		OssClient:         ossClient,
		DefaultUserConfig: defaultUserConfig,
	}
	userController := controller.NewUserController(engine, middlewares, userService)
	menuCache := cache.NewMenuCache(redisWrapper)
	menuDB := db.NewMenuDB(gormDB)
	menuRepo := &repository.MenuRepo{
		MenuCache:   menuCache,
		MenuDB:      menuDB,
		RoleMenusDB: roleMenusDB,
	}
	menuService := &service.MenuService{
		MenuRepo: menuRepo,
		RoleRepo: roleRepo,
	}
	menuController := controller.NewMenuController(engine, middlewares, menuService)
	roleService := &service.RoleService{
		RoleRepo: roleRepo,
		MenuRepo: menuRepo,
		GormTX:   gormTransactionManager,
	}
	roleController := controller.NewRoleController(engine, middlewares, roleService)
	digitPredictDB := db.NewDigitPredictDB(gormDB)
	digitPredictRepo := &repository.DigitPredictRepo{
		DigitPredictDB: digitPredictDB,
	}
	digitPredict := bootstrap.InitDigitPredict(configConfig)
	digitPredictService := &service.DigitPredictService{
		DigitPredictRepo:   digitPredictRepo,
		DigitPredictClient: digitPredict,
		OssClient:          ossClient,
	}
	digitPredictController := controller.NewDigitPredictController(engine, middlewares, digitPredictService)
	browserAgentDB := db.NewBrowserAgentDB(gormDB)
	browserAgentRepo := &repository.BrowserAgentRepo{
		BrowserAgentDB: browserAgentDB,
	}
	aiModelDB := db.NewAIModelDB(gormDB)
	aiModelCache := cache.NewAIModelCache(redisWrapper)
	aiModelRepo := &repository.AIModelRepo{
		AIModelDB:    aiModelDB,
		AIModelCache: aiModelCache,
	}
	aiProviderDB := db.NewAIProviderDB(gormDB)
	aiProviderCache := cache.NewAIProviderCache(redisWrapper)
	aiProviderRepo := &repository.AIProviderRepo{
		AIProviderDB:    aiProviderDB,
		AIProviderCache: aiProviderCache,
	}
	aiModelClient := bootstrap.InitAIModelClient()
	browserAgentService := service.NewBrowserAgentService(browserAgentRepo, aiModelRepo, aiProviderRepo, aiModelClient, gormTransactionManager)
	browserAgentDashboardService := &service.BrowserAgentDashboardService{
		BrowserAgentRepo: browserAgentRepo,
	}
	hub := bootstrap.InitWebSocketHub()
	browserAgentController := controller.NewBrowserAgentController(engine, middlewares, browserAgentService, browserAgentDashboardService, hub)
	knowledgeBaseDB := db.NewKnowledgeBaseDB(gormDB)
	fileChunkDB := db.NewFileChunkDB(gormDB)
	chunkVectorDB := db.NewChunkVectorDB(gormDB)
	knowledgeBaseFileRelDB := db.NewKnowledgeBaseFileRelDB(gormDB)
	knowledgeBaseRepo := &repository.KnowledgeBaseRepo{
		KnowledgeBaseDB:        knowledgeBaseDB,
		FileChunkDB:            fileChunkDB,
		ChunkVectorDB:          chunkVectorDB,
		KnowledgeBaseFileRelDB: knowledgeBaseFileRelDB,
	}
	conversationDB := db.NewConversationDB(gormDB)
	messageDB := db.NewMessageDB(gormDB)
	conversationRepo := &repository.ConversationRepo{
		ConversationDB: conversationDB,
		MessageDB:      messageDB,
	}
	aiService := &service.AIService{
		AIModelClient:     aiModelClient,
		AIModelRepo:       aiModelRepo,
		AIProviderRepo:    aiProviderRepo,
		KnowledgeBaseRepo: knowledgeBaseRepo,
		ConversationRepo:  conversationRepo,
		OssClient:         ossClient,
		GormTX:            gormTransactionManager,
	}
	aiController := controller.NewAIController(engine, middlewares, aiService)
	slicer := bootstrap.InitSlicer(configConfig)
	knowledgeBaseService := &service.KnowledgeBaseService{
		OssClient:         ossClient,
		Slicer:            slicer,
		GormTX:            gormTransactionManager,
		AIModelClient:     aiModelClient,
		KnowledgeBaseRepo: knowledgeBaseRepo,
		AIProviderRepo:    aiProviderRepo,
		UserRepo:          userRepo,
	}
	knowledgeBaseController := controller.NewKnowledgeBaseController(engine, middlewares, knowledgeBaseService)
	operationLogRepo := &repository.OperationLogRepo{
		OperationLogDB: operationLogDB,
	}
	operationLogService := &service.OperationLogService{
		OperationLogRepo: operationLogRepo,
	}
	operationLogController := controller.NewOperationLogController(engine, middlewares, operationLogService)
	httpServer := &bootstrap.HTTPServer{
		Engine:                  engine,
		Logger:                  logger,
		AuthController:          authController,
		UserController:          userController,
		MenuController:          menuController,
		RoleController:          roleController,
		DigitPredictController:  digitPredictController,
		BrowserAgentController:  browserAgentController,
		AIController:            aiController,
		KnowledgeBaseController: knowledgeBaseController,
		OperationLogController:  operationLogController,
		Config:                  configConfig,
	}
	return httpServer
}
